<html xmlns="http://www.w3.org/1999/xhtml"
      xmlns:h="http://java.sun.com/jsf/html"
      xmlns:f="http://java.sun.com/jsf/core"
      xmlns:p="http://primefaces.org/ui"
      xmlns:ui="http://java.sun.com/jsf/facelets">

<ui:composition template="../WEB-INF/templates/template.xhtml">
    <ui:define name="title">
        Product
    </ui:define>
    <ui:define name="body">
        <f:metadata>
            <f:viewAction action="#{productBean.init}"/>
        </f:metadata>
        <h:form id="product-update">
            <p:wizard styleClass="wizard" flowListener="#{productUploadBean.onFlowProcess}">
                <p:tab id="general" title="General">
                    <p:panel header="General informations">
                        <p:panelGrid columns="2" layout="grid">
                            <h:outputLabel for="name" value="Name: * "/>
                            <p:inputText id="name" required="true" value="#{productBean.product.name}"/>
                            <h:outputLabel for="number" value="Number: * "/>
                            <p:inputText id="number" required="true" value="#{productBean.product.number}"/>
                            <h:outputLabel for="description" value="Description: * "/>
                            <p:inputTextarea id="description" required="true"
                                             value="#{productBean.product.description}"
                                             rows="4" cols="40"
                            />
                            <h:outputLabel for="category" value="Category: * "/>
                            <p:selectOneMenu id="category" required="true"
                                             value="#{categoryBean.category}"
                                             converter="#{categoryVoConverter}">
                                <f:selectItem itemLabel="Select one!" itemValue=""/>
                                <f:selectItems value="#{categoryBean.categories}" var="category"
                                               itemLabel="#{category.name}" itemValue="#{category}"/>
                                <p:ajax listener="#{categoryBean.selectOneMenuListener}" update="sub-category"/>
                            </p:selectOneMenu>
                            <h:outputLabel for="sub-category" value="Subcategory: * "/>
                            <p:selectOneMenu id="sub-category" required="true"
                                             value="#{categoryBean.subCategory}"
                                             converter="#{subCategoryVoConverter}">
                                <f:selectItem itemLabel="Select one!" itemValue=""/>
                                <f:selectItems value="#{categoryBean.subCategories}" var="subcategory"
                                               itemLabel="#{subcategory.name}" itemValue="#{subcategory}"/>
                            </p:selectOneMenu>
                        </p:panelGrid>
                    </p:panel>
                </p:tab>
                <p:tab id="file" title="Image upload">
                    <p:panel header="Upload">
                        <p:fileUpload multiple="true" mode="advanced"
                                      fileUploadListener="#{productUploadBean.fileUpload}"
                                      dragDropSupport="false" update="messages" sizeLimit="1000000"
                                      fileLimit="5" allowTypes="/(\.|\/)(gif|jpe?g|png)$/"/>
                        <p:growl id="messages" showDetail="true"/>
                    </p:panel>
                    <p:commandButton value="Upload product" action="#{productUploadBean.doCreate}" process="@this"/>
                </p:tab>
            </p:wizard>
        </h:form>
    </ui:define>
</ui:composition>
</html>